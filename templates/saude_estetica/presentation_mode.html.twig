{% extends 'layout.html.twig' %}

{% block title %}Modo apresentação · Saúde & Estética{% endblock %}

{% block stylesheets %}
    {{ parent() }}
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <link rel="stylesheet" href="/interface/themes/saude_estetica/css/theme.css">
{% endblock %}

{% block bodyclass %}se-theme{% endblock %}

{% block content %}
<main class="se-presentation" data-component="presentation-mode" data-encounter-id="{{ encounterId }}">
    <div class="se-presentation__header">
        <h1 class="mb-1">{{ patientName }}</h1>
        <p class="text-muted mb-0">{{ sessionTitle }}</p>
    </div>
    <div class="se-presentation__content">
        <div data-region="summary" class="w-100"></div>
    </div>
    <div class="se-presentation__footer">
        <div class="d-flex justify-content-between align-items-center flex-wrap gap-3">
            <div data-region="recommendations" class="flex-fill"></div>
            <div class="d-flex gap-2">
                <button type="button" class="btn btn-outline-primary rounded-pill" data-action="toggle-fullscreen">
                    Tela cheia
                </button>
                <button type="button" class="btn se-gradient-button" data-action="print">
                    Imprimir resumo
                </button>
            </div>
        </div>
    </div>
</main>
{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <script type="module">
        import { initPresentationMode } from '/interface/themes/saude_estetica/js/presentationMode.js';

        document.addEventListener('DOMContentLoaded', () => {
            initPresentationMode();

            const root = document.querySelector('[data-component="presentation-mode"]');
            if (!root) {
                return;
            }

            root.addEventListener('click', (event) => {
                if (!(event.target instanceof HTMLElement)) {
                    return;
                }

                if (event.target.matches('[data-action="toggle-fullscreen"]')) {
                    if (!document.fullscreenElement) {
                        root.requestFullscreen().catch(console.error);
                    } else {
                        document.exitFullscreen().catch(console.error);
                    }
                }

                if (event.target.matches('[data-action="print"]')) {
                    window.print();
                }
            });
        });
    </script>
{% endblock %}
